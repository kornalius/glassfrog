{{#if encryptedFields}}
  var encryptedPlugin = mongooseEncrypted.plugins.encryptedPlugin;
{{/if}}
{{#if passwordFields}}
  var passwordPlugin = require('../mongoose_plugins/mongoose-password');
{{/if}}
{{#if addressFields}}
  var addressPlugin = require('../mongoose_plugins/mongoose-address');
{{/if}}
{{#if commentsFields}}
  var commentsPlugin = require('../mongoose_plugins/mongoose-comments');
{{/if}}
{{#if likesFields}}
  var historyPlugin = require('../mongoose_plugins/mongoose-likes');
{{/if}}
{{#if orderFields}}
  var orderPlugin = require('../mongoose_plugins/mongoose-order');
{{/if}}
{{#if personFields}}
  var personPlugin = require('../mongoose_plugins/mongoose-person');
{{/if}}
{{#if pictureFields}}
  var picturePlugin = require('../mongoose_plugins/mongoose-picture');
{{/if}}
{{#if softDeleteFields}}
  var soft_delete = require('mongoose-softdelete');
{{/if}}
{{#if fullTextFields}}
  var searchPlugin = require('mongoose-search-plugin');
{{/if}}

{{#if extendSchema}}
  var {{schema}} = {{extendSchema}}.extend({
{{else}}
  var {{schema}} = mongoose.Schema({
{{/if}}
{{{generate_nodes node false user 'Field' ','}}}
}
{{#if extendSchema}}
  , { discriminatorKey : '_type' }
{{/if}}
);

{{schema}}.plugin(timestampPlugin);
{{#if encryptedFields}}
  {{schema}}.plugin(encryptedPlugin);
{{/if}}
{{#if passwordFields}}
  {{schema}}.plugin(passwordPlugin);
{{/if}}
{{#if addressFields}}
  {{schema}}.plugin(addressPlugin);
{{/if}}
{{#if commentsFields}}
  {{schema}}.plugin(commentsPlugin);
{{/if}}
{{#if likesFields}}
  {{schema}}.plugin(likesPlugin);
{{/if}}
{{#if orderFields}}
  {{schema}}.plugin(orderPlugin);
{{/if}}
{{#if personFields}}
  {{schema}}.plugin(personPlugin);
{{/if}}
{{#if pictureFields}}
  {{schema}}.plugin(picturePlugin);
{{/if}}
{{#if softDeleteFields}}
  {{schema}}.plugin(soft_delete);
{{/if}}
{{#if fullTextFields}}
  {{schema}}.plugin(searchPlugin, { fields: [{{{fullTextFields}}}] });
{{/if}}

{{{generate_nodes node false user 'Schema.Method' '\n'}}}

{{{generate_nodes node false user 'Schema.Static' '\n'}}}

module.exports.{{schema}} = {{schema}}
